# åŸºç¡€é…ç½®æ¨¡å— - å¸¸è§„è®¾ç½®
# ç«¯å£å’ŒåŸºç¡€é…ç½®
port: 7890
allow-lan: true
bind-address: "*"
mode: rule
log-level: info
unified-delay: true
global-client-fingerprint: chrome
secret: 62132

# é”šç‚¹å®šä¹‰
rules-domain: &rules-domain 
  type: http
  interval: 86400
  behavior: domain

rules-ip: &rules-ip 
  type: http
  interval: 86400
  behavior: ipcidr

rules-classical: &rules-classical 
  type: http
  interval: 86400
  behavior: classical

# DNSé…ç½®æ¨¡å— - ç™½åå•æ¨¡å¼
dns:
  enable: true
  ipv6: false
  respect-rules: true
  enhanced-mode: 
  fake-ip-filter:
    - "*"
    - "+.lan"
    - "+.local"
    - "+.market.xiaomi.com"
  nameserver:
    - https://120.53.53.53/dns-query
    - https://223.5.5.5/dns-query
  proxy-server-nameserver:
    - https://120.53.53.53/dns-query
    - https://223.5.5.5/dns-query
  nameserver-policy:
    "geosite:cn,private":
      - https://120.53.53.53/dns-query
      - https://223.5.5.5/dns-query
    "geosite:geolocation-!cn":
      - "https://dns.cloudflare.com/dns-query"
      - "https://dns.google/dns-query"

proxy-groups:
  # ----------------------------------------------------------------
  # ğŸ¯ æ ¸å¿ƒå…¥å£ç­–ç•¥ç»„ (è¿™æ˜¯è§„åˆ™ä¸­ä¸»è¦å¼•ç”¨çš„ç»„)
  # ----------------------------------------------------------------
  - name: ğŸ¯ PROXY  
    interval: 86400
    timeout: 500
    url: "https://www.gstatic.com/generate_204"
    lazy: true
    max-failed-times: 3
    type: select
    proxies:
      - âœˆï¸ æ™®é€šèŠ‚ç‚¹  # æ—¥å¸¸ä½¿ç”¨ï¼Œé€Ÿåº¦æœ€å¿«çš„æ™®é€šèŠ‚ç‚¹
      - ğŸš€ è‡ªåŠ¨ç²¾é€‰  # æœ€ä¼˜ä½†æˆæœ¬ç•¥é«˜çš„é€‰æ‹©ï¼Œé€Ÿåº¦å¿«æˆ–ipå¥½çš„ç²¾é€‰èŠ‚ç‚¹
      - ğŸ‘† æ‰‹åŠ¨é€‰æ‹©  # è¿›å…¥æ‰‹åŠ¨é€‰æ‹©æ¨¡å¼
      - ğŸ  æˆ‘çš„èŠ‚ç‚¹  # è‡ªå·±çš„VPS
      - DIRECT

  # ----------------------------------------------------------------
  # ğŸ“ˆ è‡ªåŠ¨æµ‹é€Ÿåˆ†ç»„ (URL-Test)
  # ----------------------------------------------------------------
  - name: âœˆï¸ æ™®é€šèŠ‚ç‚¹
    interval: 86400
    timeout: 500
    url: "https://www.gstatic.com/generate_204"
    lazy: true
    max-failed-times: 3
    type: url-test
    proxies: []
    icon: "https://fyzfly.oss-cn-beijing.aliyuncs.com/img/202409161436790.svg"

  - name: ğŸš€ è‡ªåŠ¨ç²¾é€‰
    interval: 300
    timeout: 500
    url: "https://www.gstatic.com/generate_204"
    lazy: true
    max-failed-times: 3
    type: url-test
    proxies: []

  # ----------------------------------------------------------------
  # ğŸ‘† æ‰‹åŠ¨é€‰æ‹©ä¸åŒºåŸŸåˆ†ç»„ (Select)
  # ----------------------------------------------------------------
  - name: ğŸ‘† æ‰‹åŠ¨é€‰æ‹©
    interval: 300
    timeout: 500
    url: "https://www.gstatic.com/generate_204"
    lazy: true
    type: select
    proxies:
      - ğŸ  æˆ‘çš„èŠ‚ç‚¹ 
      - ğŸ‡ºğŸ‡¸ ç¾å›½
      - ğŸ‡¯ğŸ‡µ æ—¥æœ¬
      - ğŸ‡­ğŸ‡° é¦™æ¸¯
      - ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡
      - ğŸ‡¹ğŸ‡¼ å°æ¹¾
      - ğŸ‡³ğŸ‡¬ å°¼æ—¥åˆ©äºš
      - ğŸŒ å…¶ä»–åœ°åŒº


  # --- å„åŒºåŸŸå…·ä½“åˆ†ç»„ ---
  - name: ğŸ‡ºğŸ‡¸ ç¾å›½
    interval: 300
    timeout: 500
    url: "https://www.gstatic.com/generate_204"
    lazy: true
    max-failed-times: 3
    type: select
    proxies: []

  - name: ğŸ‡¯ğŸ‡µ æ—¥æœ¬
    interval: 300
    timeout: 500
    url: "https://www.gstatic.com/generate_204"
    lazy: true
    max-failed-times: 3
    type: select
    proxies: []

  - name: ğŸ‡­ğŸ‡° é¦™æ¸¯
    interval: 300
    timeout: 500
    url: "https://www.gstatic.com/generate_204"
    lazy: true
    max-failed-times: 3
    type: select
    proxies: []


  - name: ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡
    interval: 300
    timeout: 500
    url: "https://www.gstatic.com/generate_204"
    lazy: true
    max-failed-times: 3
    type: select
    proxies: []


  - name: ğŸ‡¹ğŸ‡¼ å°æ¹¾
    interval: 300
    timeout: 500
    url: "https://www.gstatic.com/generate_204"
    lazy: true
    max-failed-times: 3
    type: select
    proxies: []


  - name: ğŸ‡³ğŸ‡¬ å°¼æ—¥åˆ©äºš
    interval: 30000
    timeout: 500
    url: "https://www.gstatic.com/generate_204"
    lazy: true
    max-failed-times: 3
    type: select
    proxies: []

  - name: ğŸŒ å…¶ä»–åœ°åŒº
    interval: 86400
    timeout: 500
    url: "https://www.gstatic.com/generate_204"
    lazy: true
    max-failed-times: 3
    type: select
    proxies: []

  # ----------------------------------------------------------------

  - name: "[Auto] ç¾å›½"
    interval: 300
    timeout: 500
    url: "https://www.gstatic.com/generate_204"
    lazy: true
    max-failed-times: 3
    type: url-test
    proxies: []

  - name: "[Auto] æ—¥æœ¬"
    interval: 300
    timeout: 500
    url: "https://www.gstatic.com/generate_204"
    lazy: true
    max-failed-times: 3
    type: url-test
    proxies: []

  - name: "[Auto] é¦™æ¸¯"
    interval: 300
    timeout: 500
    url: "https://www.gstatic.com/generate_204"
    lazy: true
    max-failed-times: 3
    type: url-test
    proxies: []
  
  - name: "[Auto] æ–°åŠ å¡"
    interval: 300
    timeout: 500
    url: "https://www.gstatic.com/generate_204"
    lazy: true
    max-failed-times: 3
    type: url-test
    proxies: []

  - name: "[Auto] å°æ¹¾"
    interval: 300
    timeout: 500
    url: "https://www.gstatic.com/generate_204"
    lazy: true
    max-failed-times: 3
    type: url-test
    proxies: []

  - name: "[Auto] å°¼æ—¥åˆ©äºš"
    interval: 86400
    timeout: 500
    url: "https://www.gstatic.com/generate_204"
    lazy: true
    max-failed-times: 3
    type: url-test
    proxies: []

  - name: "[Auto] å…¶ä»–åœ°åŒº"
    interval: 86400
    timeout: 500
    url: "https://www.gstatic.com/generate_204"
    lazy: true
    max-failed-times: 3
    type: url-test
    proxies: []

  # ----------------------------------------------------------------
  # ğŸ  è‡ªå»ºèŠ‚ç‚¹ä¸ç‰¹æ®Šç”¨é€”åˆ†ç»„
  # ----------------------------------------------------------------
  - name: ğŸ  æˆ‘çš„èŠ‚ç‚¹
    interval: 3000
    timeout: 500
    url: "https://www.gstatic.com/generate_204"
    lazy: true
    max-failed-times: 3
    type: select
    proxies: []

  - name: ğŸ¤– AI ä¸“ç”¨
    interval: 3000
    timeout: 500
    url: "https://www.gstatic.com/generate_204"
    lazy: true
    max-failed-times: 3
    type: select
    proxies:
      - webshare 
      - ğŸ‡ºğŸ‡¸ ç¾å›½
      - ğŸ‡¯ğŸ‡µ æ—¥æœ¬
      - ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡
      - ğŸ‡¹ğŸ‡¼ å°æ¹¾
      - ğŸŒ å…¶ä»–åœ°åŒº
      - ğŸ  æˆ‘çš„èŠ‚ç‚¹

  # ----------------------------------------------------------------
  # ğŸ›¡ï¸ åŠŸèƒ½æ€§åˆ†ç»„
  # ----------------------------------------------------------------
  - name: æ‹¦æˆªå¹¿å‘Š
    type: select
    proxies:
      - "REJECT"
      - "DIRECT"
    icon: "https://fastly.jsdelivr.net/gh/clash-verge-rev/clash-verge-rev.github.io/main/docs/assets/icons/block.svg"

  - name: æ¼ç½‘ä¹‹é±¼
    type: select
    proxies:
      - DIRECT
      - ğŸ¯ PROXY
    icon: "https://fastly.jsdelivr.net/gh/clash-verge-rev/clash-verge-rev.github.io/main/docs/assets/icons/fish.svg"

# è§„åˆ™é…ç½®æ¨¡å— - åŒ…å«è§„åˆ™é›†å’Œè·¯ç”±è§„åˆ™
# æ³¨æ„ï¼šæ­¤æ¨¡å—æä¾›åŸºç¡€çš„è§„åˆ™é›†å’Œè§„åˆ™é…ç½®
# substore è„šæœ¬å¯èƒ½ä¼šè¦†ç›–æˆ–è¡¥å……è¿™äº›é…ç½®
rule-providers:
  # ä¸ªäººä¸“ç”¨
  ry-direct:
    <<: *rules-classical
    url: "https://github.com/rammusry/rules/raw/refs/heads/main/rules/ry-rule-direct.yaml"
    path: ./ruleset/ry-direct.yaml

  ry-proxy:
    <<: *rules-classical
    url: "https://github.com/rammusry/rules/raw/refs/heads/main/rules/ry-rule-proxy.yaml"
    path: ./ruleset/ry-proxy.yaml

  ry-reject:
    <<: *rules-classical
    url: "https://github.com/rammusry/rules/raw/refs/heads/main/rules/ry-rule-reject.yaml"
    path: ./ruleset/ry-reject.yaml
  
  ry-pure:
    <<: *rules-classical
    url: "https://github.com/rammusry/rules/raw/refs/heads/main/rules/ry-rule-pure.yaml"
    path: ./ruleset/ry-pure.yaml

  # AI ç±»
  OpenAI:
    <<: *rules-classical
    path: ./rules/blackmatrix7/OpenAI.yaml
    url: "https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/OpenAI/OpenAI.yaml"

  Gemini:
    <<: *rules-classical
    path: ./rules/blackmatrix7/Gemini.yaml
    url: "https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Gemini/Gemini.yaml"

  Anthropic:
    <<: *rules-classical
    path: ./rules/blackmatrix7/Claude.yaml
    url: "https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Anthropic/Anthropic.yaml"

  Copilot:
    <<: *rules-classical
    path: ./rules/blackmatrix7/Copilot.yaml
    url: "https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Copilot/Copilot.yaml"

  # å¹¿å‘Šç±»
  Advertising:
    <<: *rules-classical
    path: ./rules/blackmatrix7/Advertising_Classical.yaml
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Advertising/Advertising_Classical.yaml"

  # éœ€è¦ä»£ç†
  gfw:
    <<: *rules-domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/gfw.txt"
    path: ./ruleset/Loyalsoldier/gfw.yaml

  proxy:
    <<: *rules-domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/proxy.txt"
    path: ./ruleset/Loyalsoldier/proxy.yaml

  tld-not-cn:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/tld-not-cn.txt"
    path: ./ruleset/Loyalsoldier/tld-not-cn.yaml

  ProxyClient:
    <<: *rules-classical
    path: ./rules/zuluion/ProxyClient.yaml
    url: "https://cdn.jsdelivr.net/gh/zuluion/Clash-Template-Config@master/Filter/ProxyClient.yaml"

  # æ— éœ€ä»£ç†
  ChinaDomain:
    <<: *rules-domain
    path: ./rules/ACL4SSR/ChinaDomain.yaml
    url: "https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/ChinaDomain.list"

  ChinaCompanyIp:
    <<: *rules-ip
    path: ./rules/ACL4SSR/ChinaCompanyIp.yaml
    url: "https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/ChinaCompanyIp.list"

  cncidr:
    <<: *rules-ip
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/cncidr.txt"
    path: ./ruleset/Loyalsoldier/cncidr.yaml

  lancidr:
    <<: *rules-ip
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/lancidr.txt"
    path: ./ruleset/Loyalsoldier/lancidr.yaml

  # æœåŠ¡ç±»
  Talkatone:
    <<: *rules-classical
    url: "https://raw.githubusercontent.com/mottzz87/crules/refs/heads/main/rule/talkatone.list"
    path: ./ruleset/mottzz87/talkatone.list

  Telegram:
    <<: *rules-classical
    url: "https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Telegram/Telegram.yaml"
    path: ./ruleset/blackmatrix7/Telegram.yaml

  # æ¸¸æˆç±»
  Steam:
    type: http
    behavior: classical
    format: yaml
    path: ./rules/Steam.yaml
    url: "https://cdn.jsdelivr.net/gh/zuluion/Clash-Template-Config@master/Filter/Steam.yaml"
    interval: 86400

# è·¯ç”±è§„åˆ™é…ç½®
# è¯·è®¾ç½®åŸŸåç±»è§„åˆ™ä¼˜å…ˆï¼Œipç±»è§„åˆ™ç½®åï¼
rules:
  - PROCESS-NAME,com.talkatone.android,ğŸ¤– AI ä¸“ç”¨
  - RULE-SET,ry-direct,DIRECT
  - RULE-SET,ry-proxy,ğŸ¯ PROXY
  - RULE-SET,ry-reject,æ‹¦æˆªå¹¿å‘Š
  - RULE-SET,ry-pure,ğŸ¤– AI ä¸“ç”¨
  - RULE-SET,OpenAI,ğŸ¤– AI ä¸“ç”¨
  - RULE-SET,Gemini,ğŸ¤– AI ä¸“ç”¨
  - RULE-SET,Anthropic,ğŸ¤– AI ä¸“ç”¨
  - RULE-SET,Copilot,ğŸ¤– AI ä¸“ç”¨
  - RULE-SET,gfw,ğŸ¯ PROXY
  - RULE-SET,proxy,ğŸ¯ PROXY
  - RULE-SET,tld-not-cn,ğŸ¯ PROXY
  - RULE-SET,ProxyClient,ğŸ¯ PROXY,no-resolve
  - RULE-SET,Telegram,ğŸ¯ PROXY
  - RULE-SET,Steam,ğŸ¯ PROXY
  - RULE-SET,ChinaDomain,DIRECT
  - RULE-SET,ChinaCompanyIp,DIRECT,no-resolve
  - RULE-SET,cncidr,DIRECT,no-resolve
  - RULE-SET,lancidr,DIRECT,no-resolve
  - RULE-SET,Advertising,æ‹¦æˆªå¹¿å‘Š
  - GEOSITE,cn,DIRECT
  - MATCH, æ¼ç½‘ä¹‹é±¼